<Tool
  name="calculator"
  description="Calculates the result of a math expression."
  parameters={{
    type: 'object',
    properties: {
      expression: {
        type: 'string',
        description: 'expression to eval with JavaScript',
      },
    },
    required: ['expression'],
  }}
  run={({ expression }) => '' + eval(expression)}
/>

<Tool
  name="search"
  description="A search engine. Useful for when you need to answer questions about current events. Input should be a search query."
  parameters={{
    type: 'object',
    properties: {
      query: {
        type: 'string',
        description: 'search query',
      },
    },
    required: ['query'],
  }}
  run={async ({ query }) => {
    const resp = await fetch(
      'https://serpapi.com/search.json?api_key=' +
        process.env.SERP_API_KEY +
        '&engine=google&q=' +
        encodeURIComponent(query)
    )
    const json = await resp.json()
    if (json.answer_box?.answer) {
      return json.answer_box.answer
    } else if (json.answer_box?.snippet) {
      return json.answer_box.snippet
    } else if (json.answer_box?.snippet_highlighted_words) {
      return json.answer_box.snippet_highlighted_words[0]
    } else if (json.sports_results?.game_spotlight) {
      return json.sports_results.game_spotlight
    } else if (json.knowledge_graph?.description) {
      return json.knowledge_graph.description
    } else if (json.organic_results[0] && json.organic_results[0].snippet) {
      return json.organic_results[0].snippet
    }
    return 'No good search result found'
  }}
/>

<User>
How old is Olivia Wilde? What's her age raised to the .23 power?
</User>

<Request model="gpt-4-0613" />