<Tool
  name="calculator"
  description="Calculates the result of a math expression."
  schema={z.object({ expression: z.string().describe('expression to eval with JavaScript') })}
  run={({ expression }) => '' + eval(expression)}
/>

<Tool
  name="search"
  description="A search engine. Useful for when you need to answer questions about current events. Input should be a search query."
  schema={z.object({ query: z.string().describe('search query') })}
  run={async ({ query }) => {
    const resp = await fetch(
      'https://serpapi.com/search.json?api_key=' +
        process.env.SERP_API_KEY +
        '&engine=google&q=' +
        encodeURIComponent(query)
    )
    const json = await resp.json()
    if (json.answer_box?.answer) {
      return json.answer_box.answer
    } else if (json.answer_box?.snippet) {
      return json.answer_box.snippet
    } else if (json.answer_box?.snippet_highlighted_words) {
      return json.answer_box.snippet_highlighted_words[0]
    } else if (json.sports_results?.game_spotlight) {
      return json.sports_results.game_spotlight
    } else if (json.knowledge_graph?.description) {
      return json.knowledge_graph.description
    } else if (json.organic_results[0] && json.organic_results[0].snippet) {
      return json.organic_results[0].snippet
    }
    return 'No good search result found'
  }}
/>

<User>
who is Olivia Wilde's boyfriend? What is his current age raised to the 0.23 power?
</User>

<Request model="gpt-4-0613" />